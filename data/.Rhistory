getwd()
setwd("data")
getwd()
bird.yeartotal <- read.csv('bird_yeartotal.csv')
library(plyr)
# checks: get the total bird for the 10 more common species on 3 forest each year
tab_f <- function(x) {
x <- x[order(x$count, decreasing=T),]
data.frame(head(x[,c('count','abbrev')],10) )
}
tab <- ddply(bird.yeartotal, .(year,forest), tab_f)
# pull out year 2007 to compare with the online report
library(reshape)
aux<-reshape(subset(tab, year==2007) , direction='wide', timevar='forest', idvar='abbrev',drop='year')
# Overall trend within forest
library(ggplot2)
totales <- ddply(bird.yeartotal, .(year,forest), summarise, count=sum(count) )
totales$forest <- factor(totales$forest)
install.packages(c("reshape","ggplot2"))
# pull out year 2007 to compare with the online report
library(reshape)
aux<-reshape(subset(tab, year==2007) , direction='wide', timevar='forest', idvar='abbrev',drop='year')
# Overall trend within forest
library(ggplot2)
totales <- ddply(bird.yeartotal, .(year,forest), summarise, count=sum(count) )
totales$forest <- factor(totales$forest)
m_f = function(x) {
m = lm(ave ~ I(year-2000) + I((year-2000)^2), x)
data.frame(parameter=c("b0","b1","b2","sigma"),
estimate=c(coef(m), summary(m)$sigma))
}
models.lm = ddply(bird.yeartotal, .(forest,abbrev), m_f)
tab1 <- ddply(models.lm, .(forest,parameter),function(x) summary(x$estimate) )
library(xtable)
xtable(tab1, digits=3)
tab
aux
library(xtable)
tab = xtable(aux)
print(tab, file="highcounts.tex")
?print.xtable
print(tab, file="highcounts.tex", include.rownames=FALSE)
help(package=lme4)
?lmer
library(lme4)
help(package=lme4)
?lmer
mrnd_f <- function(x) {
x$year <- x$year-1994
x$abbrev <- factor(x$abbrev)
x$lave <- log(x$ave)
x$lave[x$lave==-Inf] <- NA
mod <-lmer(lave ~ year+I(year^2)+(year+I(year^2)|abbrev),data=x)
data.frame(parameter=c("b0","b1","b2","residual"),
mean=c(fixef(mod)[1:3],0), variance=c(attributes(VarCorr(mod)$abbrev)$stddev,attributes(VarCorr(mod))$sc) )
}
models.rnd = ddply(bird.yeartotal, .(forest), mrnd_f)
mod <-lmer(lave ~ year+I(year^2)+(year+I(year^2)|abbrev),data=x)
mod <-lmer(lave ~ year+I(year^2)+(year+I(year^2)|abbrev),data=bird.yeartotal)
bird.yeartotal$year = bird.yeartotal$year-2000
mod <-lmer(lave ~ year+I(year^2)+(year+I(year^2)|abbrev),data=bird.yeartotal)
mod <-lmer(log(ave) ~ year+I(year^2)+(year+I(year^2)|abbrev),data=bird.yeartotal)
mod
mod <-lmer(log(ave+.1) ~ year+I(year^2)+(year+I(year^2)|abbrev),data=bird.yeartotal)
mod
mod <-lmer(log(ave+.1) ~ year+I(year^2)+(year|abbrev)+(I(year^2)|abbrev),data=bird.yeartotal)
mod
mod <-lmer(log(ave+.1) ~ year+I(year^2)+(1|abbrev)+(year-1|abbrev)+(I(year^2)-1|abbrev),data=bird.yeartotal)
mod
